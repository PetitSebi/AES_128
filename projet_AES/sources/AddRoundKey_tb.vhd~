-- SÃ©bastien Dosset 06/12/16
-- AddRoundKey Test Bench

library IEEE;
use IEEE.std_logic_1164.all;
use IEEE.numeric_std.all;
library lib_sources;
use lib_sources.crypt_pack.all;

entity AddRoundKey_tb is
end AddRoundKey_tb;

architecture AddRoundKey_tb_arch of AddRoundKey_tb is

	component AddRoundKey
		port(
		state_i :        in type_state;
		currentKey_i :   in type_key;
		dataOutValid_i : in std_logic;
		state_o :        out type_state;
		data_o :         out std_logic_vector(127 downto 0));
	end component;

	signal state_i_s : type_state;
	signal currentKey_i_s : type_key;
	signal dataOutValid_i_s : std_logic;
	signal state_o_s : type_state;
	signal data_o_s : std_logic_vector(127 downto 0);	

begin

	DUT : AddRoundKey
		port map(
		state_i   => state_i_s,
		currentKey_i => currentKey_i_s,
		dataOutValid_i => dataOutValid_i_s,
		state_o   => state_o_s,
		data_o => data_o_s);

	state_i_s(0)(0) <= x"57";
	state_i_s(0)(1) <= x"3b";
	state_i_s(0)(2) <= x"85";
	state_i_s(0)(3) <= x"6b";
	state_i_s(1)(0) <= x"46";
	state_i_s(1)(1) <= x"fe";

	data_o_s <= x"0000000000000000";

	currentKey_i_s(0)(0) <= x"12";
	currentKey_i_s(0)(1) <= x"34";
	currentKey_i_s(0)(2) <= x"56";
	currentKey_i_s(0)(3) <= x"78";
	currentKey_i_s(1)(0) <= x"9a";
	currentKey_i_s(1)(1) <= x"bc";

end AddRoundKey_tb_arch;

