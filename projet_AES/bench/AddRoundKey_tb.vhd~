-- SÃ©bastien Dosset 06/12/16
-- AddRoundKey Test Bench

library IEEE;
use IEEE.std_logic_1164.all;
use IEEE.numeric_std.all;
library lib_sources;
use lib_sources.crypt_pack.all;

entity AddRoundKey_tb is
end AddRoundKey_tb;

architecture AddRoundKey_tb_arch of AddRoundKey_tb is

	component AddRoundKey
		port(
		state_i :        in type_state;
		currentKey_i :   in type_key;
		dataOutValid_i : in std_logic;
		state_o :        out type_state;
		data_o :         out std_logic_vector(127 downto 0));
	end component;

	signal state_i_s : type_state;
	signal currentKey_i_s : type_key;
	signal dataOutValid_i_s : std_logic:='0';
	signal state_o_s : type_state;
	signal data_o_s : std_logic_vector(127 downto 0);	

begin

	DUT : AddRoundKey
		port map(
		state_i   => state_i_s,
		currentKey_i => currentKey_i_s,
		dataOutValid_i => dataOutValid_i_s,
		state_o   => state_o_s,
		data_o => data_o_s);

	state_i_s(0)(0) <= x"ae";
	state_i_s(1)(0) <= x"69";
	state_i_s(2)(0) <= x"94";
	state_i_s(3)(0) <= x"f8";
	state_i_s(0)(1) <= x"b8";
	state_i_s(1)(1) <= x"41";
	state_i_s(2)(1) <= x"c8";
	state_i_s(3)(1) <= x"92";
	state_i_s(0)(2) <= x"01";
	state_i_s(1)(2) <= x"2c";
	state_i_s(2)(2) <= x"f7";
	state_i_s(3)(2) <= x"e8";
	state_i_s(0)(3) <= x"08";
	state_i_s(1)(3) <= x"ed";
	state_i_s(2)(3) <= x"1d";
	state_i_s(3)(3) <= x"83";

	dataOutValid_i_s <= '0', '1' after 300 ns;

	currentKey_i_s(0)(0) <= x"5a";
	currentKey_i_s(0)(1) <= x"a0";
	currentKey_i_s(0)(2) <= x"88";
	currentKey_i_s(0)(3) <= x"f4";
	currentKey_i_s(1)(0) <= x"db";
	currentKey_i_s(1)(1) <= x"a4";
	currentKey_i_s(1)(2) <= x"ab";
	currentKey_i_s(1)(3) <= x"de";
	currentKey_i_s(2)(0) <= x"16";
	currentKey_i_s(2)(1) <= x"c5";
	currentKey_i_s(2)(2) <= x"22";
	currentKey_i_s(2)(3) <= x"23";
	currentKey_i_s(3)(0) <= x"12";
	currentKey_i_s(3)(1) <= x"94";
	currentKey_i_s(3)(2) <= x"69";
	currentKey_i_s(3)(3) <= x"f8";

end AddRoundKey_tb_arch;

